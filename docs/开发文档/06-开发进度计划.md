# Mini-Todo - 开发进度计划

## 1. 开发阶段概览

| 阶段 | 内容 | 预计时间 | 状态 |
|------|------|----------|------|
| 阶段1 | 基础架构搭建 | 2-3小时 | 已完成 |
| 阶段2 | 核心功能开发 | 3-4小时 | 已完成 |
| 阶段3 | 通知系统 | 1-2小时 | 待开始 |
| 阶段4 | 窗口特殊功能 | 2-3小时 | 已完成 |
| 阶段5 | 数据导入导出 | 1小时 | 待开始 |
| 阶段6 | UI美化与测试 | 2小时 | 待开始 |

**总计预估时间**：11-15 小时

---

## 2. 阶段1：基础架构搭建

### 2.1 任务清单

- [x] 配置 Tauri 窗口属性
  - 设置窗口尺寸 (380x600)
  - 配置透明窗口支持
  - 禁用默认标题栏
- [x] 前端项目结构搭建
  - 创建组件目录结构
  - 配置 Pinia 状态管理
  - 配置 SCSS 样式系统
- [x] 安装前端依赖
  - pinia
  - vuedraggable
  - dayjs
  - sass
  - element-plus
- [x] 后端项目结构搭建
  - 创建模块目录结构
  - 配置 Cargo 依赖
- [x] SQLite 数据库集成
  - 添加 rusqlite 依赖
  - 实现数据库连接
  - 创建初始表结构

### 2.2 交付物

- 可运行的基础应用框架
- 数据库初始化完成
- 自定义标题栏显示

---

## 3. 阶段2：核心功能开发

### 3.1 任务清单

- [x] 待办 CRUD 操作
  - 创建待办命令
  - 查询待办命令
  - 更新待办命令
  - 删除待办命令
- [x] 子任务管理
  - 添加子任务
  - 更新子任务
  - 删除子任务
  - 完成子任务
- [x] 前端待办列表组件
  - TodoList 组件
  - TodoItem 组件
  - SubTaskList 组件
  - SubTaskItem 组件
- [x] 待办编辑弹窗
  - 基本信息表单
  - 优先级选择器
  - 时间选择器
  - 子任务管理区
- [x] 拖拽排序功能
  - 集成 vuedraggable
  - 实现拖拽排序
  - 保存排序顺序

### 3.2 交付物

- 完整的待办 CRUD 功能
- 子任务管理功能
- 拖拽排序功能

---

## 4. 阶段3：通知系统

### 4.1 任务清单

- [ ] 集成通知插件
  - 安装 tauri-plugin-notification
  - 配置通知权限
- [ ] 实现通知调度器
  - 定时检查逻辑
  - 通知发送逻辑
- [ ] 前端通知时间设置
  - 时间选择器
  - 提前时间选项
  - 自定义时间输入

### 4.2 交付物

- Windows 系统通知功能
- 可配置的提醒时间

---

## 5. 阶段4：窗口特殊功能

### 5.1 任务清单

- [x] 自定义标题栏
  - 模式切换按钮
  - 窗口控制按钮
  - 拖拽区域
- [x] 普通模式实现
  - 窗口拖拽
  - 最小化/关闭功能
  - 白色背景
- [x] 固定模式实现
  - 100%透明背景（仅文字和图标可见）
  - 禁用拖拽
  - 禁用关闭/最小化
  - 窗口置顶
  - 忽略 Win+D (WS_EX_TOOLWINDOW)
- [x] 窗口位置记忆
  - 保存位置到数据库
  - 启动时恢复位置

### 5.2 交付物

- 完整的模式切换功能
- 固定模式所有特性

---

## 6. 阶段5：数据导入导出

### 6.1 任务清单

- [ ] 数据导出功能
  - JSON 序列化
  - 文件保存对话框
  - 导出完成提示
- [ ] 数据导入功能
  - 文件选择对话框
  - JSON 解析验证
  - 导入确认对话框
  - 合并/覆盖选项

### 6.2 交付物

- 完整的导入导出功能
- 数据迁移能力

---

## 7. 阶段6：UI美化与测试

### 7.1 任务清单

- [ ] UI 细节完善
  - 动画效果
  - 过渡效果
  - 响应式优化
- [ ] 固定模式样式
  - 透明背景效果
  - 毛玻璃效果
- [ ] 功能测试
  - CRUD 功能测试
  - 拖拽排序测试
  - 通知功能测试
  - 模式切换测试
  - 导入导出测试
- [ ] Bug 修复

### 7.2 交付物

- 完善的 UI 体验
- 稳定的应用程序

---

## 8. 里程碑

| 里程碑 | 完成标准 | 状态 |
|--------|----------|------|
| M1 | 基础框架可运行 | 已完成 |
| M2 | 待办 CRUD + 子任务完成 | 已完成 |
| M3 | 通知功能可用 | 待开始 |
| M4 | 固定模式完成 | 已完成 |
| M5 | 全部功能完成，可发布 | 进行中 |

---

## 9. 风险与应对

| 风险 | 可能性 | 影响 | 应对策略 |
|------|--------|------|----------|
| Win+D 忽略难以实现 | 中 | 高 | 研究 Windows API，考虑替代方案 |
| 透明窗口性能问题 | 低 | 中 | 优化渲染，减少重绘 |
| 拖拽排序体验不佳 | 低 | 中 | 调整动画参数，优化交互 |
| 通知权限问题 | 低 | 低 | 提供权限引导 |

---

## 10. 技术备忘

### 10.1 Windows 窗口置顶忽略 Win+D

```rust
// 使用 WS_EX_TOOLWINDOW 或 WS_EX_APPWINDOW 样式
// 配合 SetWindowPos 设置 HWND_TOPMOST
```

### 10.2 透明窗口配置

```json
// tauri.conf.json
{
  "app": {
    "windows": [{
      "transparent": true,
      "decorations": false
    }]
  }
}
```

### 10.3 定时任务调度

```rust
// 使用 tokio 的定时器
tokio::spawn(async {
    let mut interval = tokio::time::interval(Duration::from_secs(60));
    loop {
        interval.tick().await;
        check_notifications().await;
    }
});
```
